<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>STREAM Dashboard</title>
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="stylesheet" href="styles.css">
</head>

<body data-theme="dark" class="view--grid">
  <!-- Header -->
  <div class="topbar no-select">
    <div class="topbar__inner">
      <div class="brand">
        <img src="/favicon.png" alt="Logo" class="logo" style="height:24px;vertical-align:middle;margin-right:6px;" />
        <span>STREAM Dashboard</span>
      </div>
      <label class="search" title="Filter by name or ID">
        <span aria-hidden="true">🔎</span>
        <input id="filter" placeholder="Search streams..." autocomplete="off" />
      </label>
      <div class="hdr-right">
        <button id="toggleTheme" class="themeBtn" title="Toggle theme">🌗 Theme</button>
      </div>
    </div>
  </div>

  <!-- Command bar -->
  <div class="command no-select">
    <div class="command__inner">
      <div class="seg" role="tablist" aria-label="View modes">
        <button id="viewGrid" role="tab" aria-pressed="true" title="Grid view">Grid</button>
        <button id="viewTheater" role="tab" aria-pressed="false" title="Theater (single wide column)">Theater</button>
        <button id="viewList" role="tab" aria-pressed="false" title="List (compact stack)">List</button>
      </div>
      <div class="counters">
        <span id="countStreams" class="chip ok" title="Streams online">0 online</span>
        <span id="countPlayers" class="chip info" title="Players opened">0 playing</span>
      </div>
    </div>
  </div>

  <!-- Grid -->
  <div class="shell" role="main">
    <section id="grid" class="grid no-select" aria-live="polite"></section>
  </div>

  <!-- Focus view -->
  <div id="focus" class="focus" role="dialog" aria-modal="true" aria-label="Focused stream">
    <div class="focusInner">
      <div id="focusHost"></div>
    </div>
  </div>

  <!-- Viewer modal -->
  <div id="viewerModal" class="modal" hidden>
    <div class="modal__inner">
      <div class="modal__hd">
        <div class="title">👁 Viewers</div>
        <button class="btn modal__close" id="viewerModalClose">✕</button>
      </div>
      <div id="viewerModalBody" class="modal__body"></div>
    </div>
  </div>

  <!-- Media lightbox -->
  <div id="lightbox" class="modal" hidden>
    <div class="modal__inner">
      <div class="modal__hd">
        <div class="title">Preview</div>
        <button class="btn modal__close" id="lightboxClose">✕</button>
      </div>
      <div class="modal__body" id="lightboxBody"></div>
    </div>
  </div>

  <!-- Toast host -->
  <div class="toastHost" id="toastHost"
    style="position:fixed;right:16px;bottom:16px;display:flex;flex-direction:column;gap:8px;z-index:95"></div>

  <!-- Chat -->
  <div id="chatBox" class="chat">
    <div class="chat__tab" id="chatFab" title="Toggle chat">💬</div>

    <div class="chat__panel" id="chatPanel" hidden>
      <div class="chat__hd">
        <div class="chat__title">Chat</div>
        <div class="chat__me" id="chatMe">—</div>
        <div class="chat__tools">
          <button id="chatClose" class="btn" title="Close">✕</button>
        </div>
      </div>

      <div id="chatList" class="chat__list"></div>

      <!-- Composer -->
      <form id="chatForm" class="chat__form">
        <div class="chat__inputWrap" style="position:relative; flex:1">
          <textarea id="chatInput" class="chat__input"
            placeholder="Type a message… (Enter = send, Shift+Enter = newline)"></textarea>

          <!-- Small preview lives inside the textbox (absolute) -->
          <div id="attachPreview" class="attachPreview" hidden>
            <button type="button" class="attachPreview__remove" title="Remove">✕</button>
            <div class="attachPreview__media"></div>
          </div>
        </div>

        <input type="file" id="chatFile" accept="image/*,video/*" hidden />
        <button type="button" id="chatAttach" class="btn" title="Attach image/video">📎</button>
        <button type="button" id="emojiBtn" class="btn" title="Emoji">😊</button>
        <button type="submit" class="btn">Send</button>

        <!-- Emoji popover -->
        <div id="emojiPanel" class="picker" hidden></div>
      </form>

    </div>
  </div>

  <script type="module" src="app.js"></script>
</body>

</html>
